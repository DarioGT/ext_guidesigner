<html>
	<head>
		<link rel="stylesheet" type="text/css" href="../extjs/resources/css/ext-all.css" />
		<script type="text/javascript" src="../extjs/adapter/ext/ext-base.js"></script>
		<script type="text/javascript" src="../extjs/ext-all-debug.js"></script>

		<script src="../lib/Test/Builder.js" type="text/javascript"></script>
		<script src="../lib/Test/More.js" type="text/javascript"></script>

		<!--The custom script to test -->
		<script src="../js/Ext.ux.Util.js" type="text/javascript"></script>
		<script src="../js/Ext.ux.Json.js" type="text/javascript"></script>
		
		<!-- General components  -->
	    <script id="js/Ext.ux.Util.js" type="text/javascript" src="../js/Ext.ux.Util.js"></script>
	    <script id="js/Ext.ux.Override.js" type="text/javascript" src="../js/Ext.ux.Override.js"></script>
	    <script id="js/Ext.ux.ComponentCollection.js" type="text/javascript" src="../js/Ext.ux.ComponentCollection.js"></script>
		
        <script id="js/localXHR.js" type="text/javascript" src="../js/localXHR.js"></script>
	    
		<!-- Add Code press as script editor, remove line below to used textarea as script editor  -->
		<script id="js/codepress/Ext.ux.CodePress.js" type="text/javascript" src="../js/codepress/Ext.ux.CodePress.js"></script>
	    
	    
	    <!-- Designer functions -->
	    <link id="css/Ext.ux.plugin.Designer.css" rel="stylesheet" type="text/css" href="../css/Ext.ux.plugin.Designer.css" />
	    <script id="js/Ext.ux.data.HttpMergeProxy.js" type="text/javascript" src="../js/Ext.ux.data.HttpMergeProxy.js"></script>
		<script id="js/Ext.ux.tree.CodeLoader.js" type="text/javascript" src="../js/Ext.ux.tree.CodeLoader.js"></script>
	    <script id="js/Ext.ux.form.ScriptEditor.js" type="text/javascript" src="../js/Ext.ux.form.ScriptEditor.js"></script>
	    <script id="js/Ext.ux.grid.PropertyGrid.js" type="text/javascript" src="../js/Ext.ux.grid.PropertyGrid.js"></script>
	    <script id="js/Ext.ux.plugin.FileControl.js" type="text/javascript" src="../js/Ext.ux.plugin.FileControl.js"></script>
	    <script id="js/Ext.ux.plugin.CookieFiles.js" type="text/javascript" src="../js/Ext.ux.plugin.CookieFiles.js"></script>
	    <script id="js/Ext.ux.plugin.PHPFiles.js" type="text/javascript" src="../js/Ext.ux.plugin.PHPFiles.js"></script>
	    <script id="js/Ext.ux.plugin.Designer.js" type="text/javascript" src="../js/Ext.ux.plugin.Designer.js"></script>
	    
		<script id="js/Ext.ux.JsonPanel.js" type="text/javascript" src="../js/Ext.ux.JsonPanel.js"></script>
		<script id="js/Ext.ux.JsonWindow.js" type="text/javascript" src="../js/Ext.ux.JsonWindow.js"></script>
		<script id="js/Ext.ux.tree.JsonTreeLoader.js" type="text/javascript" src="../js/Ext.ux.tree.JsonTreeLoader.js"></script>
	    

		<!--The test function that fires when body is loaded -->
		<script>
			Ext.onReady(function(){
				plan({ tests: 1 });

				//diag('Designer operations:');
				var phpSupport;
				var designer;
				var designer_panel = new Ext.Panel({
					applyTo : 'designer',
					height : 500,
					border:false,
	                bodyBorder:false,
	                bodyStyle:'background:black;border:dashed green 1px;',
					plugins : [
						designer = new Ext.ux.plugin.Designer({
							toolboxTarget : 'toolbox',
							disableCaching : true,
							customProperties : true,
							fileControl      : phpSupport ? new Ext.ux.plugin.PHPFiles() : new Ext.ux.plugin.CookieFiles()
						})
					]
					
				});
				
				var config = '\
/* This file is created or modified with Ext.ux.plugin.GuiDesigner */\
{\
width : 800,\
height : 500,\
modal : true,\
title : "title",\
layout : "border",\
items : [{\
    region : "west",\
    split : true,\
    width : 300,\
    xtype : "form",\
    slot : "add_place_form",\
    bodyStyle : "padding:10px",\
    labelAlign : "top",\
    onSubmit : Ext.emptyFn,\
    submit : Ext.emptyFn,\
    buttons : [{\
                        xtype : "button",\
                        text : "add",\
                        handler : this.addPlaceSubmit,\
                        scope : this\
                    },{\
                        xtype : "button",\
                        text : "cancel",\
                        handler : function () {\
                            this.close();\
                        },\
                        scope : this\
                    }],\
    items : [{\
        xtype : "textfield",\
        fieldLabel : "name",\
        name : "place_name",\
        anchor : "98%"\
      },{\
        anchor : "98%",\
        xtype : "panel",\
        border : false,\
        defaults : {\
                            border : false\
                        },\
        layout : "column",\
        items : [{\
            columnWidth : 0.99,\
            layout : "form",\
            items : [{\
                xtype : "textfield",\
                slot : "add_place_address_fld",\
                fieldLabel : "address",\
                name : "place_adr",\
                anchor : "98%"\
              }],\
            border : false\
          },{\
            width : 60,\
            bodyStyle : "padding-top:18px",\
            items : [{\
                id : "add_place_geocode_btn",\
                xtype : "button",\
                text : "search",\
                handler : this.geoCode,\
                scope : this\
              }],\
            border : false\
          }]\
      },{\
        anchor : "98%",\
        xtype : "panel",\
        border : false,\
        defaults : {\
                            border : false\
                        },\
        layout : "column",\
        items : [{\
            columnWidth : 0.5,\
            layout : "form",\
            items : [{\
                xtype : "textfield",\
                id : "add_place_lat_fld",\
                fieldLabel : "lat",\
                name : "place_lat",\
                anchor : "98%"\
              }],\
            border : false\
          },{\
            columnWidth : 0.5,\
            layout : "form",\
            items : [{\
                xtype : "textfield",\
                id : "add_place_lng_fld",\
                fieldLabel : "long",\
                name : "place_lng",\
                anchor : "98%"\
              }],\
            border : false\
          },{\
            width : 85,\
            bodyStyle : "padding-top:18px",\
            items : [{\
                id : "add_place_marker_btn",\
                xtype : "button",\
                text : "set"\
              }],\
            border : false\
          }]\
      },{\
        xtype : "textarea",\
        fieldLabel : "desc",\
        name : "place_desc",\
        anchor : "98%"\
      }]\
  },{\
    id : "add_place_gmap",\
    region : "center",\
    xtype : "panel",\
    gMapCustomize : this.gMapCustomize,\
    gMapCustomizeScope : this\
  }]\
}\
				';
				
				designer.setConfig(config);
				
				var cfg = designer.getConfig();
				
				var w = new Ext.Window(Ext.apply({
                    title  : 'Show Config', 
                    border  : false,
                    width:600,
                    height: 400,
                    iconCls: 'icon-show',
                    modal       : true,
                    maximizable : true,
                    closeAction : 'close',
                    items       : cfg,
                    listeners   : { 'beforeclose' : function(){
                                      //scope.container.enable();
                                  }} 
                    },cfg.json));
                w.show();
				
				pass('ok');
			});
		</script>
	</head>

 	<body>
		<H1>Ext.ux.Json test suite</H1>
		<div id="designer"></div>
		
	</body>
 </html>